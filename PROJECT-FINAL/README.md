# PROJECT-FINAL. Предсказание вероятности диабета по данным диагностических мероприятий

 ## Оглавление
 [1. Описание проекта](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-FINAL/README.md#Описание-проекта)

 [2. Какой кейс решаем?](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-FINAL/README.md#Какой-кейс-решаем)

 [3. Краткая информация о данных](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-FINAL/README.md#Краткая-информация-о-данных)

 [4. Этапы работы над проектом](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-FINAL/README.md#Этапы-работы-над-проектом)

 [5. Результаты](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-FINAL/README.md#Результаты)
 
 [6. Выводы](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-FINAL/README.md#Выводы)

### Описание пректа

Предстоит решить задачу в области медицины и здравоохранения и предсказать начало диабета на основе диагностических мероприятий.

**Диабет** — это заболевание, которое возникает, когда уровень глюкозы в крови, также называемый сахаром в крови, слишком высок. Глюкоза в крови является вашим основным источником энергии и поступает из пищи, которую вы едите. Инсулин, гормон, вырабатываемый поджелудочной железой, помогает глюкозе из пищи попадать в ваши клетки и использоваться для получения энергии. Иногда ваше тело не вырабатывает достаточно инсулина или вообще не вырабатывает его или не использует его должным образом. Глюкоза остается в крови и не достигает клеток.

По данным ВОЗ около 422 миллионов человек во всем мире страдают диабетом. Поскольку диабет поражает большое количество людей во всем мире, сбор этих наборов данных является непрерывным процессом и включает в себя различные атрибуты, связанные с пациентом, такие как возраст, пол, симптомы, уровень инсулина, артериальное давление, уровень глюкозы в крови, вес и т. д. 

В данном проекте ма работаем над набором данных о диабете индейцев пима. Набор данных изначально получен из Национального института диабета, болезней органов пищеварения и почек. Целью набора данных является диагностическое прогнозирование наличия у пациента диабета на основе определенных диагностических измерений, включенных в набор данных. На выбор этих экземпляров из большей базы данных было наложено несколько ограничений. В частности, все пациенты здесь — женщины не моложе 21 года индейского происхождения пима.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-FINAL/README.md#Оглавление)

### Какой кейс решаем?

**Бизнес-задача:** определить медицинские показатели, по которым можно выявить пациентов, более склонных к заболеванию диабетом, и за счёт этого повысить эффективность ранней диагностики и профилактики диабета, а также успешности своевременного лечения.

**Техническая задача** как для специалиста в Data Science: построить модель машинного обучения, которая на основе полученных медицинских показателей пациента в результате диагностических мероприятий будет предсказывать, заболеет ли он диабетом или нет.

**Основные цели:**
1. Произвести предобработку набора данных.
2. Провести разведывательный анализ данных (EDA) и выявить основные закономерности.
4. Построить несколько моделей машинного обучения, решающих задачу классификации пациентов.
5. Использовать разные инструменты для повышения качества прогноза.
5. Спроектировать процесс предсказания возникновения диабета и оценить качество прогнозирования на тестовой выборке.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-FINAL/README.md#Оглавление)

### Краткая информация о данных

В данном датесете, посвященном диабету, содержатся следующие **признаки** (факторы):
* Pregnancies - Количество беременностей;
* Glucose - Концентрация глюкозы в плазме крови через 2 часа при пероральном тесте на толерантность к глюкозе (мг/дл);
* BloodPressure - Диастолическое кровяное давление (мм рт. ст.);
* SkinThickness - Толщина кожной складки трицепса (мм);
* Insulin - 2-часовой сывороточный инсулин (ме Ед/мл);
* BMI - Индекс массы тела (вес в кг/ (рост в м)^2);
* DiabetesPedigreeFunction - Функция родословной диабета;
* Age - Возраст (годы).

А также **целевой признак** наличия диабета:
* Outcome - Переменная класса (0 или 1)

Все пациенты в данном датасете — женщины не моложе 21 года индейского происхождения Пима, которые стали добровольцами для проведения научных исследований. Многие индианки из племени Пима страдают диабетом.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-FINAL/README.md#Оглавление)

### Этапы работы над проектом

1. Знакомство с данными;
2. Предобработка и очистка данных от пропусков и выбросов;
3. Разведывательный анализ данных (EDA);
4. Преобразование признаков (стандартизация);
5. Решение задачи классификации (создание baseline): логистическая регрессия и решающие деревья, - и подбор оптимальных параметров модели;
6. Решение задачи классификации: метод опорных векторов и метод k-ближайших соседей;
7. Решение задачи классификации: ансамбли моделей и построение прогноза;
8. Сравнение результатов разных моделей машинного обучения;
9. Итоговые выводы по проекту.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-FINAL/README.md#Оглавление)

### Результаты

- Проведено знакомство с данными датасета;
- Обработаны пропуски и выбросы;
- Проведен EDA и выявлены зависимости в данных;
- Оценена мультиколлинеарность и взаимосвязь признаков с целевой переменной;
- Проведена стандартизация предикторов с помощию StandardScaler;
- Построен baseline: логистическая регрессия и дерево решений;
- Подобраны оптимальные параметры для дерева рещений с помощью GridSearchCV;
- Обучены дополнительные модели классификации: метод опорных векторов и метод k-ближайших соседей;
- Обучены ансамбли моделей, а именно: случайный лес, градиентный бустинг, стекинг из ранее построенных моделей, а также ExtraTreesClassifier;
- Определены оптимальные гиперпараметры с помощью Optuna и построен случайный лес для предсказания;
- Определены признаки, которые демонстрируют наибольшую  важность в модели случайного леса. Использована визуализация;
- Оценено качество моделей машинного обучения;
- Проведено сравнение качества предсказания обученных моделей машинного обучения для метрик accuracy и f1-score;
- Сделаны промежуточные и итоговые выводы по ходу проекта.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-FINAL/README.md#Оглавление)

### Выводы

Диабет – это глобальная проблема всего мира. По данным ВОЗ, на сегодняшний день диабетом страдает около 422 млн человек, что составляет 6,028% от всего населения планеты. Статистика заболеваемости диабетом ежегодно растёт. Осложняет положение дел то факт, что в настоящее время лечение сахарного диабета в подавляющем большинстве случаев является симптоматическим и направлено на устранение имеющихся симптомов без устранения причины заболевания, так как **эффективного лечения диабета ещё не разработано**. Поэтому в данном случае **роль профилактики и ранней диагностики становится наиболее значимой и важной**. Data Science может внести свою лепту и помочь повысить мониторинг пациентов и улучшить раннюю диагностику диабета.

В результате выполнения проекта, были построены различные модели машинного обучения. **Наиболее точные прогнозы дают ансамблевые модели**, а именно, случайный лес, градиентный бустинг, а также стекинг из логистической регрессии, дерева решений, случайного леса и градиентного бустинга. Самые высокие результаты были получены для градиентного бустинга: метрика accuracy равна 0.8947, а метрика f1-score - 0.9286. Такому достойному результату поспособствовала качественная предобработка данных - выявление и работа с пропусками и выбросами. Тем не менее, случайный лес и стекинг уступают градиентному бустингу на одну-две сотые. Таким образом, данные модели можно уверенно использовать для прогнозирования начала диабета для новых медицинских показателей - новых пациентов. Они дадут надежный результат предсказания.

Что касается важности признаков (факторов, предикторов), то согласно модели случайного леса, наибольшей значимостью в диагностике начала диабета обладают такие медицинские характеристики, как уровень инсулина, толщина кожной складки трицепса, уровень глюкозы, возраст и индекс массы тела. Такой результат обусловливает важность соблюдения здорового образа жизни и поддержки оптимальной массы тела. Кроме того, что касается генетической предрасположенности к диабету, то значимость данного признака находится на предпоследнем месте, что также говорит о большей роли эпигенетики (80%), а на генетику приходится в среднем 20%. В эпигенетику входят: питание, образ жизни, наличие либо отсутствие вредных привычек, социальное положение, медицина и психологическое состояние. Можно сказать, что генетика — это как фитиль от бомбы, а эпигенетика — это искра, которая в случае попадания на этот фитиль может привести к взрыву.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-FINAL/README.md#Оглавление)