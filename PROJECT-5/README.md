# PROJECT-4. Задача регрессии

 ## Оглавление
 [1. Описание проекта](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-5/README.md#Описание-проекта)

 [2. Какой кейс решаем?](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-5/README.md#Какой-кейс-решаем)

 [3. Краткая информация о данных](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-5/README.md#Краткая-информация-о-данных)

 [4. Этапы работы над проектом](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-5/README.md#Этапы-работы-над-проектом)

 [5. Результаты](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-5/README.md#Результаты)
 
 [6. Выводы](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-5/README.md#Выводы)


### Описание пректа 

→ Представьте, что вы заказываете такси из одной точки Нью-Йорка в другую, причём необязательно, что конечная точка должна находиться в пределах города. Сколько вы должны будете заплатить за поездку?

Известно, что стоимость такси в США рассчитывается на основе фиксированной ставки и тарифной стоимости, величина которой зависит от времени и расстояния. Тарифы варьируются в зависимости от города.

В свою очередь, время поездки зависит от множества факторов, таких как направление поездки, время суток, погодные условия и так далее.

Таким образом, если разработать алгоритм, способный определять длительность поездки, мы сможем прогнозировать её стоимость самым тривиальным образом, например, просто умножая стоимость на заданный тариф.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-5/README.md#Оглавление)

### Какой кейс решаем?

**Бизнес-задача:** определить характеристики и с их помощью спрогнозировать длительность поездки на такси.

**Техническая задача** как для специалиста в Data Science: построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать числовой признак — время поездки такси, то есть решить задачу регрессии.

**Основные цели:**
1. Сформировать набор данных на основе нескольких источников информации.
2. Спроектировать новые признаки с помощью Feature Engineering и выявить наиболее значимые при построении модели.
3. Исследовать предоставленные данные и выявить закономерности.
4. Построить несколько моделей и выбрать из них ту, которая показывает наилучший результат по заданной метрике.
5. Спроектировать процесс предсказания длительности поездки для новых данных.
6. Загрузить своё решение на платформу Kaggle, тем самым поучаствовав в настоящем Data Science-соревновании.

### Краткая информация о данных

Данные о клиенте и таксопарке:
* id — уникальный идентификатор поездки;
* vendor_id — уникальный идентификатор поставщика услуг (таксопарка), связанного с записью поездки.

Временные характеристики:
* pickup_datetime — дата и время, когда был включён счётчик поездки;
* dropoff_datetime — дата и время, когда счётчик был отключён.

Географическая информация:
* pickup_longitude — долгота, на которой был включён счётчик;
* pickup_latitude — широта, на которой был включён счётчик;
* dropoff_longitude — долгота, на которой счётчик был отключён;
* dropoff_latitude — широта, на которой счётчик был отключён.

Прочие признаки:
* passenger_count — количество пассажиров в транспортном средстве (введённое водителем значение);
* store_and_fwd_flag — флаг, который указывает, сохранилась ли запись о поездке в памяти транспортного средства перед отправкой поставщику (Y — хранить и пересылать, N — не хранить и не пересылать поездку).

Целевой признак:
* trip_duration — продолжительность поездки в секундах.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-5/README.md#Оглавление)

### Этапы работы над проектом

1. Первичная обработка данных: сформировать набор данных на основе предложенных источников информации и обработать пропуски и выбросы в данных.

2. Разведывательный анализ данных (EDA): исследовать данные, выявить первые закономерности и выдвинуть гипотезы.

3. Отбор и преобразование признаков: перекодировать и преобразовать данные таким образом, чтобы их можно было использовать при решении задачи регрессии — для построения модели.

4. Решение задачи регрессии: линейная регрессия и деревья решений: создать baseline, который поможет ответить на вопрос: «Решаема ли вообще представленная задача?»

5. Решение задачи регрессии: ансамбли моделей и построение прогноза: доработать предсказание с использованием более сложных алгоритмов и оценить, с помощью какой модели возможно сделать более качественные прогнозы.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-5/README.md#Оглавление)

### Результаты

- Обработаны пропуски и выбросы;
- Проведен EDA, выявлены зависимости;
- Закодированы категориальные признаки;
- Оценена мультиколлинеарность и взаимосвязь признаков с целевой переменной;
- Отобраны 15 признаков с помощью SelectKBest, которые наилучшим образом подходят для использования в задаче классификации;
- Проведена нормализация предикторов с помощию Min-Max-нормализации;
- Построена логистическая реграссия;
- Построена модель решающих деревьев, подобраны оптимальные гиперпараметры с помощью GridSearch;
- Обучен случайный лес, градиентный бустинг, стекинг из ранее построенных моделей;
- Определены признаки, которые демонстрируют наибольшую  важность в модели градиентного бустинга;
- Определены оптимальные гиперпараметры с помощью Optuna и построен случайный лес для предсказания;
- Оценено качество моделей.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-5/README.md#Оглавление)

### Выводы
Ансамбли моделей, в частности случайный лес, дают наиболее точные прогнозы открытия клиентами депозитов. Методы по оптимизации гиперпараментов (GridSearch, Optuna) также помогают улучшить качество модели. Наиболее значимыми признаками в модели градиентного бустинга оказались: duration (продолжительность контакта в секундах), poutcome_success (успешный результат прошлой маркетинговой кампании) и contact_unknown (неизвестный тип контакта с клиентом). На данные факторы стоит обратить особое внимание ввиду сильного влияния на результат маркетинговой компании.
Достигнутое качество моделирования на тестовой выборке по метрике accuracy составило 0.81-0.83 в зависимости от конкретной модели ML.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-5/README.md#Оглавление)