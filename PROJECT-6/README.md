# PROJECT-6. Сегментирование клиентов онлайн-магазина подарков

 ## Оглавление
 [1. Описание проекта](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-6/README.md#Описание-проекта)

 [2. Какой кейс решаем?](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-6/README.md#Какой-кейс-решаем)

 [3. Краткая информация о данных](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-6/README.md#Краткая-информация-о-данных)

 [4. Этапы работы над проектом](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-6/README.md#Этапы-работы-над-проектом)

 [5. Результаты](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-6/README.md#Результаты)
 
 [6. Выводы](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-6/README.md#Выводы)


### Описание пректа 

Предстоит решить бизнес-задачу в области маркетинга и произвести сегментацию клиентов на основе их покупательской способности, частоты совершения заказов и срока давности последнего заказа, а также определить оптимальную стратегию взаимодействия с ними.

Маркетинг — неотъемлемая часть любого бизнеса. Для повышения прибыли компании важно понимать своего клиента, его пожелания и предпочтения. С появлением электронной коммерции, или онлайн-продаж, стало намного проще собирать данные о клиентах, анализировать их, находить закономерности и реализовывать маркетинговые кампании.

Большинство интернет-магазинов используют инструменты веб-аналитики, чтобы отслеживать просмотры страниц, количество и поведение посетителей и коэффициент отказов. Но отчёта из Google Analytics или аналогичной системы может быть недостаточно для полного понимания того, как клиенты взаимодействуют с сайтом. Компаниям важно иметь возможность быстро и точно реагировать на перемены в поведении клиентов, создавая инструменты, которые обнаруживают эти изменения практически в режиме реального времени.

Машинное обучение помогает поисковой системе анализировать огромное количество данных о посетителях платформы, узнавать модели поведения профессиональных покупателей, определять категорию клиентов (например, лояльные/перспективные/новички/«спящие»/ушедшие) и выбирать правильную стратегию взаимодействия с ними.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-6/README.md#Оглавление)

### Какой кейс решаем?

**Бизнес-задача:** произвести сегментацию существующих клиентов, проинтерпретировать эти сегменты и определить стратегию взаимодействия с ними.

**Техническая задача** как для специалиста в Data Science: построить модель кластеризации клиентов на основе их покупательской способности, частоты заказов и срока давности последней покупки, определить профиль каждого из кластеров.

**Основные цели:**
1. Произвести предобработку набора данных.
2. Провести разведывательный анализ данных и выявить основные закономерности.
3. Сформировать категории товаров и клиентов.
4. Построить несколько моделей машинного обучения, решающих задачу кластеризации клиентов, определить количество кластеров и проинтерпретировать их.
5. Спроектировать процесс предсказания категории интересов клиента и протестировать вашу модель на новых клиентах.

### Краткая информация о данных

Как правило, наборы данных для электронной коммерции являются частной собственностью и, следовательно, их трудно найти среди общедоступных данных.

Однако в The UCI Machine Learning Repository создали набор данных, содержащий фактические транзакции за 2010 и 2011 годы. С ним нам как раз и предстоит поработать в этом проекте.
Датасет содержит все транзакции, произошедшие за период с 01/12/2010 по 09/12/2011, для базирующейся в Великобритании компании, занимающейся розничной онлайн-торговлей. Компания в основном продаёт уникальные подарки на все случаи жизни. Многие клиенты являются оптовиками.

Данные включают в себя информацию о более чем полумиллионе транзакций. Каждая из них описывается следующими признаками:

* InvoiceNo — номер счёта-фактуры (уникальный номинальный шестизначный номер, присваиваемый каждой транзакции; буква "C" в начале кода указывает на отмену транзакции);
* StockCode — код товара (уникальное пятизначное целое число, присваиваемое каждому отдельному товару);
* Description — название товара;
* Quantity — количество каждого товара за транзакцию;
* InvoiceDate — дата и время выставления счёта/проведения транзакции;
* UnitPrice — цена за единицу товара в фунтах стерлингов;
* CustomerID — идентификатор клиента (уникальный пятизначный номер, однозначно присваиваемый каждому клиенту);
* Country — название страны, в которой проживает клиент.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-6/README.md#Оглавление)

### Этапы работы над проектом

1. Базовый анализ и знакомство с данными.
2. Предобработка и очистка данных от пропусков, дублей, выбросов и другого «мусора».
3. Разведывательный анализ данных (EDA)
4. RFM-сегментация клиентов. Часть I. Знакомство с популярным в маркетинге методом сегментации клиентов под названием RFM (Recency, Frequency, Monetary). На основе этого метода необходимо сформировать из исходного датасета о транзакциях таблицу с RFM-характеристиками клиентов и произвести их первичную сегментацию.
5. RFM-сегментация клиентов. Часть II. Расширение клиентских сегментов и создание промежуточных категорий с помощью нелинейных преобразований размерности. Это позволит произвести более качественную кластеризацию и улучшить стратегии взаимодействия с клиентами.
6. RFM-сегментация клиентов. Часть III. Построение модели классификации, которая позволит автоматически определять сегмент клиента на основе нескольких транзакций.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-6/README.md#Оглавление)

### Результаты

На основе исходного датасета с помощью метода сегментации клиентов RFM сформирована таблица с RFM-характеристиками. С помощью метода главных компонент (PCA), линейного метода отображения исходного пространства признаков в его сжатую версию, - пространство признаков сжато до двух компонент. С помощью коэффициента силуэта подобрано оптимальное количество кластеров. Произведена кластеризация клиентов с помощью методов k-means и GaussianMixture.

С помощью алгоритма t-SNE RFM-таблица, очищенная от выбросов, трансформирована в двухмерное представление. С помощью коэффициента силуэта подобрано оптимальное количество кластеров. Произведена кластеризация клиентов с помощью методов k-means, GaussianMixture и алгоритма алгомеративной кластеризации AgglomerativeClustering.

Проблема t-SNE заключается в том, что алгоритм непараметрический. Это значит, что он, в отличие от таких алгоритмов, как PCA и SVD, не создаёт явной функции отображения. Проще говоря, алгоритм трансформирует пространство признаков для обучающей выборки, но не запоминает, каким образом это делает. Это значит, что, передав в алгоритм новые объекты для сжатия пространства, будет получено абсолютно новое представление пространства, не имеющее отношения к тому, что было построено для обучающей выборки. То есть произойдёт искажение, что может привести к неверным результатам кластеризации.

Для преодоления данной проблемы при предсказании сегмента для клиентов, которые не попали в обучающую выборку, осуществен переход от задачи кластеризации к задаче классификации, так как есть истинные метки кластеров и есть клиенты, которые описываются RFM-характеристиками.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-6/README.md#Оглавление)

### Выводы
При использовании метода снижения размерности PCA алгоритм K-means продемонстировал наибольший коэффициент силуэта, а при использовании алгоритма снижения размерности t-SNE - алгоритм AgglomerativeClustering.

Для составления профиля кластеров осуществлен переход от декомпозированных данных к RFM-таблице, очищенной от выбросов. RFM-таблица сгруппирована по полученным кластерам и рассчитано среднее по каждому из признаков. Визуализированы профили кластеров в виде полярной диаграммы на основе средних RFM-характеристик, вычисленных для каждого кластера. Даны описания каждому кластеру клиентов.

С помощью GridSearchCV организован перебор параметров случайного леса (RandomForestClassifier) и градиентного бустинга (GradientBoostingClassifier). Сделаны предсказания классов на тестовых выборках.

Наилучший результат при классификации продемонстировала модель градиентного бустинга (GradientBoostingClassifier), для которой после предсказания для тестовой выборки метрика accuracy составила 0.992.

Таким образом, была преодолена проблема непараметричности t-SNE и осуществлен переход от решения задачи кластеризации к задаче классификации. По итогу есть модель, которая на основе RFM-характерик клиента автоматически определяет его сегмент.

:arrow_up:[ к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-6/README.md#Оглавление)