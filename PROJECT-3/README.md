# PROJECT-3. EDA + Feature Engineering. Соревнование на Kaggle 

 ## Оглавление
 [1. Описание проекта](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-3/README.md#Описание-проекта)

 [2. Какой кейс решаем?](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-3/README.md#Какой-кейс-решаем)

 [3. Краткая информация о данных](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-3/README.md#Краткая-информация-о-данных)

 [4. Этапы работы над проектом](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-3/README.md#Этапы-работы-над-проектом)

 [5. Результаты](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-3/README.md#Результаты)
 
 [6. Выводы](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-3/README.md#Выводы)


### Описание пректа 
Представляем, что мы работаем дата-сайентистами в компании Booking. Одна из проблем компании — это нечестные отели, которые накручивают себе рейтинг. Одним из способов обнаружения таких отелей является построение модели, которая предсказывает рейтинг отеля. Если предсказания модели сильно отличаются от фактического результата, то, возможно, отель ведёт себя нечестно, и его стоит проверить.

:arrow_up:[к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-3/README.md#Оглавление)

### Какой кейс решаем?
Цель проекта: построить модель на основе алгоритмов машинного обучения, которая предсказывает рейтинг отеля.

Задачи проекта:
1. ознакомиться с входными данными;
2. изучить пример машинного обучения (scikit-learn класс RandomForestRegressor);
3. выполнить подготовку данных, которые будут использованы для обучения модели;
4. проверить эффективность предлагаемой модели, используя метрику MAPE;
5. принять участие в соревнованиях на площадке kaggle.com.


### Краткая информация о данных
Датасет содержит сведения о 515 000 отзывов на отели Европы.
Модель, которую необходимо обучить, должна предсказывать рейтинг отеля по данным сайта Booking на основе имеющихся в датасете данных. 

Первоначальная версия датасета содержит 17 полей со следующей информацией:
- hotel_address — адрес отеля;
- review_date — дата, когда рецензент разместил соответствующий отзыв;
- average_score — средний балл отеля, рассчитанный на основе последнего комментария за последний год;
- hotel_name — название отеля;
- reviewer_nationality — страна рецензента;
- negative_review — отрицательный отзыв, который рецензент дал отелю;
- review_total_negative_word_counts — общее количество слов в отрицательном отзыв;
- positive_review — положительный отзыв, который рецензент дал отелю;
- review_total_positive_word_counts — общее количество слов в положительном отзыве;
- reviewer_score — оценка, которую рецензент поставил отелю на основе своего опыта;
- total_number_of_reviews_reviewer_has_given — количество отзывов, которые рецензенты дали в прошлом;
- total_number_of_reviews — общее количество действительных отзывов об отеле;
- tags — теги, которые рецензент дал отелю;
- days_since_review — количество дней между датой проверки и датой очистки;
- additional_number_of_scoring — есть также некоторые гости, которые просто поставили оценку сервису, но не оставили отзыв. Это число указывает, сколько там действительных оценок без проверки.
- lat — географическая широта отеля;
- lng — географическая долгота отеля.

:arrow_up:[к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-3/README.md#Оглавление)

### Этапы работы над проектом

1) Загружаем необходимые для работы библиотеки;
2) Загружаем данные и объединяем трейн и тест в один датасет для корректной обработки признаков;
3) Изучаем датасет на предмет наличия пропусков и типов данных;
4) Работаем с адресом отеля: извлекаем страну и город. Кодируем данные признаки. Используя данные из Википедии, добавляем признаки численности населения извлеченных стран и городов. Удаляем признак адреса отеля;
5) Работаем с пропусками в датасете. Они определяются в признаках географической широты и долготы. Используя данные о географической широте и долготе из Википедии, заполняем пропуски на основании города, где расположен отель. Данный метод заполнения пропусков является адекватным и релеватным, поскольку в рамках города географические координаты изменяются незначительно;
6) Работаем с признаком даты: извлекаем месяц, учитывая возможное влияние сезонности на отзыв. Также извлекаем количество дней между датой проверки и датой очистки и преобразовываем к числовому типу данных;
7) Обрабатываем теги: выделяем топ-20 тегов и преобразуем строки тегов в списки тегов. Кодируем теги;
8) Работаем с признаком страны рецензента: выделяем топ-10 национальностей по активности, остальным присваиваем значение "Other". Кодируем получившиеся национальности;
9) Обрабатываем текстовые поля с отзывами. Данный этап является очень важным с точки зрения точности обучения и прогнозирования, поэтому он выполняется в несколько этапов:
- добавляем доли позитивных и негативных слов в общем количестве слов в отзыве;
- добавляем доли позитивных и негативных слов в расчете на один отзыв;
- работаем с пакетом символьной и статистической обработки естественного языка для анализа отзывов и записываем полученные результаты в датафрейм;
- считаем количество негативных и положительных слов в отзыве.
10) Убираем обработанные текстовые признаки;
11) Отбираем признаки на основании мультиколлинеарности и значимости признаков;
12) Готовим данные для модели: выделяем тестовую часть, разделяем тренинговый датасет: 80% на обучение, 20% на валидацию, - и проверяем размерности получившихся датасетов;
13) Создаем и обучаем модель;
14) Сравниваем предсказанные значения (y_pred) с реальными (y_test), и смотрим насколько они в среднем отличаются.
В качестве метрики используем Mean Absolute Error (MAE), которая показывает среднее отклонение предсказанных значений от фактических;
15) Дабавляем возможность воспроизводимости кода;
17) Загружаем код на площадку Kaggle для участия в соревновании и дублируем на GitHub.

:arrow_up:[к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-3/README.md#Оглавление)

### Результаты

- Добавлены и удалены столбцы с признаками;
- Использованы разные способы представления информации об одном и том же признаке;
- Использован дополнительный источник информации (Википедия) при проектировании признаков;
- Используйте различные преобразования признаков;
- Дата разбита на новый признак;
- Использован анализ мультиколлинеарности и значимости признаков в качестве отбора признаков для модели;
- Извлечены полезные данные из строковых признаков (из адресов, тегов и текстов отзывов);
- Использовано кодирование признаков как оцифровка некоторых строковых значений;
- Модель создана и обучена на тестовом наборе данных;
- Проведено предсказание рейтинга отелей в тестовой выборке;
- Проект создан с применением PEP8;
- Код воспроизводим;
- Проект загружен на GitHub;
- GitHub оформлен соответствующим образом;
- Построена модель машинного обучения, предсказывающая рейтинг отеля.

:arrow_up:[к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-3/README.md#Оглавление)

### Выводы
Создана первая модель, основанная на алгоритмах машинного обучения, которая предсказывает рейтинг отеля.
Проведена очистка довольно сильно загрязнённого датасета, из него извлечены несколько новых признаков и подготовлены данные для обучения модели. Также принято участие в соревновании по машинному обучению.

:arrow_up:[к оглавлению](https://github.com/Nadarsa/sf_data_science/tree/main/PROJECT-3/README.md#Оглавление)